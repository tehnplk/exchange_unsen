# Excel Reader Application

แอปพลิเคชันสำหรับอ่านไฟล์ Excel และ Export เป็น CSV ด้วย PyQt5

## คุณสมบัติ

- ✅ รองรับไฟล์ Excel (.xlsx, .xls)
- ✅ แสดงข้อมูลในรูปแบบตาราง
- ✅ Export ข้อมูลเป็นไฟล์ CSV
- ✅ รองรับการเรียงลำดับข้อมูล
- ✅ UI ภาษาไทย
- ✅ การจัดการข้อผิดพลาด
- ✅ ตั้งค่าการเชื่อมต่อ MySQL
- ✅ บันทึกการตั้งค่าใน Windows Registry
- ✅ เชื่อมต่อ MySQL อัตโนมัติ
- ✅ แสดงตัวเลขแบบมาตรฐาน (English numerals)
- ✅ เลือกคอลัมน์เพื่อเชื่อมโยงข้อมูล
- ✅ แสดงสถิติคอลัมน์ที่เลือก (ค่าไม่ซ้ำ, ค่าว่าง)
- ✅ ค้นหาและวิเคราะห์ประชากรข้อมูล
- ✅ เชื่อมโยงข้อมูลกับ MySQL ตาราง person
- ✅ เพิ่มคอลัมน์ข้อมูลจาก MySQL (cid2, fname2, lname2)
- ✅ รายงานคุณภาพข้อมูลโดยละเอียด
- ✅ ปุ่มโหลดข้อมูลกระพริบสีแดงเมื่อเลือกไฟล์

## การติดตั้ง

### 1. สร้าง Virtual Environment

```bash
python -m venv .venv
```

### 2. เปิดใช้งาน Virtual Environment

**Windows:**
```bash
.venv\Scripts\activate
```

**Linux/Mac:**
```bash
source .venv/bin/activate
```

### 3. ติดตั้ง Dependencies

```bash
pip install -r requirements.txt
```

## การใช้งาน

### 1. รันแอปพลิเคชัน

```bash
python run_app.py
```

หรือ

```bash
python excel_reader.py
```

### 2. วิธีการใช้งาน

1. **เลือกไฟล์ Excel:**
   - คลิกปุ่ม "Browse..." 
   - เลือกไฟล์ Excel (.xlsx หรือ .xls)
   - ปุ่ม "โหลดข้อมูล" จะเริ่มกระพริบเมื่อเลือกไฟล์แล้ว

2. **โหลดข้อมูล:**
   - คลิกปุ่ม "โหลดข้อมูล" (จะหยุดกระพริบเมื่อเริ่มโหลด)
   - ข้อมูลจะแสดงในตาราง
   - หลังจากโหลดสำเร็จ จะแสดง dropdown สำหรับเลือกคอลัมน์เพื่อเชื่อมโยง

3. **เลือกคอลัมน์เพื่อเชื่อมโยง:**
   - หลังจากโหลดข้อมูลแล้ว จะเห็น dropdown "เชื่อมโยงโดย:"
   - เลือกคอลัมน์ที่ต้องการจาก dropdown
   - ระบบจะแสดงข้อมูลสถิติของคอลัมน์ที่เลือก (จำนวนค่าไม่ซ้ำ, ค่าว่าง)
   - เลือก "-- ไม่เลือกคอลัมน์ --" เพื่อยกเลิกการเลือก

4. **ค้นหาประชากร:**
   - หลังจากโหลดข้อมูลแล้ว จะแสดงปุ่ม "ค้นหา"
   - ต้องเชื่อมต่อ MySQL ก่อนใช้งาน
   - เลือกคอลัมน์ที่ต้องการค้นหา (เช่น รหัสประชาชน)
   - คลิก "ค้นหา" เพื่อค้นหาข้อมูลในตาราง person ของ MySQL
   - ระบบจะเพิ่มคอลัมน์ใหม่: cid2, fname2, lname2
   - แสดงสถิติครบถ้วน, การวิเคราะห์คุณภาพข้อมูล และตัวอย่างข้อมูล

5. **Export เป็น CSV:**
   - คลิกปุ่ม "Export"
   - เลือกที่ตั้งและชื่อไฟล์ที่ต้องการบันทึก

6. **ตั้งค่า MySQL:**
   - ใช้เมนู ตั้งค่า > ตั้งค่า MySQL
   - กรอกข้อมูลการเชื่อมต่อ (Host, Port, Database, Username, Password)
   - ทดสอบการเชื่อมต่อ
   - บันทึกการตั้งค่า (จะบันทึกใน Registry)

7. **เชื่อมต่อ/ตัดการเชื่อมต่อ MySQL:**
   - ใช้เมนู ตั้งค่า > เชื่อมต่อ MySQL (F6)
   - ใช้เมนู ตั้งค่า > ตัดการเชื่อมต่อ MySQL (F7)

8. **ล้างข้อมูล:**
   - คลิกปุ่ม "ล้างข้อมูล" เพื่อเริ่มใหม่ (อยู่ก่อนปุ่ม Export)

### 3. คุณสมบัติเพิ่มเติม

- **การเรียงลำดับ:** คลิกที่หัวตารางเพื่อเรียงลำดับข้อมูล
- **การเลือกแถว:** คลิกที่แถวเพื่อเลือกข้อมูล
- **Menu Bar:** ใช้เมนูสำหรับฟีเจอร์ต่างๆ
- **Keyboard Shortcuts:**
  - Ctrl+O: เปิดไฟล์
  - Ctrl+E: Export
  - Ctrl+Q: ออกจากโปรแกรม
  - F5: รีเฟรชข้อมูล
  - Ctrl+M: ตั้งค่า MySQL
  - F6: เชื่อมต่อ MySQL
  - F7: ตัดการเชื่อมต่อ MySQL

## ไฟล์ในโปรเจกต์

```
ExchangeUnsen/
│
├── excel_reader.py          # ไฟล์หลักของแอปพลิเคชัน
├── excel_reader.ui          # ไฟล์ UI (XML) ของ PyQt5
├── mysql_config.py          # จัดการการตั้งค่า MySQL และ Registry
├── run_app.py               # ไฟล์สำหรับรันแอปพลิเคชัน
├── test_mysql.py            # ทดสอบการเชื่อมต่อ MySQL
├── requirements.txt         # Dependencies ที่จำเป็น
├── create_sample_excel.py   # สร้างไฟล์ Excel ตัวอย่าง
├── sample_data.xlsx         # ไฟล์ Excel ตัวอย่าง
├── data.csv                 # ไฟล์ CSV ตัวอย่าง
├── README.md               # ไฟล์นี้
└── .venv/                  # Virtual environment
```

## ทดสอบแอปพลิเคชัน

1. **สร้างไฟล์ตัวอย่าง:**
```bash
python create_sample_excel.py
```

2. **รันแอปพลิเคชัน:**
```bash
python run_app.py
```

3. **ทดสอบด้วยไฟล์ตัวอย่าง:**
   - เลือกไฟล์ `sample_data.xlsx`
   - โหลดข้อมูล
   - ทดลอง Export เป็น CSV

## Dependencies

- **PyQt5** (5.15.9): สำหรับ GUI
- **pandas** (2.0.3): สำหรับจัดการข้อมูล
- **openpyxl** (3.1.2): สำหรับไฟล์ .xlsx
- **xlrd** (2.0.1): สำหรับไฟล์ .xls
- **numpy** (1.24.3): สำหรับการคำนวณ
- **mysql-connector-python** (8.0.33): สำหรับเชื่อมต่อ MySQL

## การแก้ไขปัญหา

### ปัญหาที่อาจเกิดขึ้น:

1. **ไม่สามารถ import PyQt5 ได้:**
   ```bash
   pip install PyQt5==5.15.9
   ```

2. **ไม่สามารถอ่านไฟล์ Excel ได้:**
   ```bash
   pip install openpyxl xlrd
   ```

3. **ข้อผิดพลาดเกี่ยวกับ encoding:**
   - ไฟล์ CSV จะบันทึกด้วย utf-8-sig
   - รองรับภาษาไทย

4. **UI ไม่แสดงภาษาไทย:**
   - ตรวจสอบฟอนต์ระบบ
   - ใช้ฟอนต์ Tahoma (default)

5. **ไม่สามารถเชื่อมต่อ MySQL ได้:**
   ```bash
   pip install mysql-connector-python==8.0.33
   ```
   - ตรวจสอบการตั้งค่า MySQL Server
   - ตรวจสอบ username/password
   - ตรวจสอบ firewall settings

6. **การตั้งค่าไม่บันทึกใน Registry:**
   - ตรวจสอบสิทธิ์ในการเขียน Registry
   - รันโปรแกรมในฐานะ Administrator (ถ้าจำเป็น)

## การพัฒนาเพิ่มเติม

### เพิ่มฟีเจอร์ใหม่:
- การกรองข้อมูล
- การแก้ไขข้อมูลในตาราง
- การบันทึกเป็นรูปแบบอื่น (JSON, XML)
- การเชื่อมต่อฐานข้อมูล

### การปรับแต่ง UI:
- เปลี่ยน theme/สี
- เพิ่ม icon
- ปรับขนาดฟอนต์
- เพิ่ม toolbar

## ข้อมูลผู้พัฒนา

พัฒนาด้วย:
- Python 3.10+
- PyQt5
- pandas
- สนับสนุนภาษาไทย

## License

Open Source - ใช้งานได้อย่างอิสระ
